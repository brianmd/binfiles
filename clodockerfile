FROM clojure:latest

RUN apt-get update && \
    apt-get install -y maven

ARG USERNAME=summit
ARG USERID=1000

RUN echo "username:$USERNAME"
RUN echo "userid:$USERID"

RUN addgroup -gid $USERID $USERNAME && \
    adduser --disabled-password --gecos '' -u $USERID --gid $USERID $USERNAME

RUN echo "cleaning up" && \
  # apk del wget && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* && \
    rm -f  /var/cache/apk/*

# 7100=nrepl, 7101=cljs-nrepl, 3449=fig-http-server, 
EXPOSE 7100 7101 7102 3449

RUN mkdir -p /home/$USERNAME/project
WORKDIR /home/$USERNAME/project
USER $USERNAME
ENV HOME /home/$USERNAME

